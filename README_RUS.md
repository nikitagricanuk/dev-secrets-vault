# Документация к проекту 

Цель проекта — разработка альтернативного решения для безопасного хранения и управления секретами, функционально аналогичного HashiCorp Vault. В условиях ограниченного выбора подобных решений, наш проект предлагает новый подход к решению задач управления секретами, не копируя существующие системы, а реализуя ключевые возможности собственными методами.

Мы создали безопасное API для хранения, доступа и управления секретами, уделяя особое внимание гибкости и производительности. Основные функции включают:

 • Хранение секретов с поддержкой TTL (времени жизни) и метаданных
 • Управление правами доступа на основе сессий и аутентификации через GitHub
 • Оптимизация системы сессий, позволяющая гибко настраивать политику безопасности: привязка к IP-адресам, одноразовые токены, ограничения на количество использований токенов
 • Интеграция с Redis для управления сессиями и их безопасностью

Мы отказались от использования готовых решений, таких как JWT для сессий, в пользу собственной системы, которая позволяет тонко контролировать срок действия и отзыв токенов. Это позволяет адаптировать проект под нужды конкретных сценариев использования, делая его удобным как для малых, так и для масштабных проектов.

Проект также ориентирован на безопасность и защиту данных, с проверкой HTTPS-соединений для всех запросов.

## POST /v1/auth/token/create
**Описание:**  запроса на получение токена доступа с типом авторизации по паролю.

**Метод:**  POST

**URL:**  /api/v1/token/create 

**Параметры запроса:** 
| Параметр      	| Тип    	| Описание 	|
|---------------	|--------	|----------	|
| grant_type    	| string 	|      Тип авторизации	|
| username      	| string 	|      Имя пользователя    	|
| passwor       	| string 	|     Пароль пользователя     	|
| scope         	| string 	|     Запрос на доступ      	|
| client_id     	| string 	|  Идентификатор клиента        	|
| client_secret 	| string 	|   Секрет клиента       	|

**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
* Код ответа: 422
  ```json
        {
        "detail": [
            {
            "loc": [
                "string",
                0
            ],
            "msg": "string",
            "type": "string"
            }
          ]
        }
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|   Успешное получение токена доступа       	|   	|
| 422        	|  Есть логическая ошибка        	|   	|

**Пример запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___
## POST /v1/token/renew

**Описание:**  обновление токена доступа

**Метод:**  POST

**URL:**  /api/v1/token/renew 

**Параметры запроса:** 
| Параметр      	| Тип    	| Описание 	|
|---------------	|--------	|----------	|
| refresh_token 	| string 	|      Токен обновления для получения нового токена доступа	|

**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|   Успешное обновление токена доступа         	|   	|

**Пример запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___
## POST /v1/token/revoke
**Описание:**  запрос на отзыв токена доступа или токена обновления.

**Метод:**  POST

**URL:**  /api/v1/token/revoke

**Параметры запроса:** 
| Параметр      	| Тип    	| Описание 	|
|---------------	|--------	|----------	|
| revoke_token 	| string 	|  Токен доступа или обновления, который нужно отозвать

**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|   Успешное        отзыв токена доступа или токена обновления 	|   	|

**Привер запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___
## POST /v1/users/create 

**Описание:**  запроса на созданиe нового пользователя в системе.

**Метод:**  POST

**URL:**  /api/v1/token/create 

**Параметры запроса:** 
| Параметр      	| Тип    	| Описание 	|
|---------------	|--------	|----------	|
| username    	| string 	|    	Имя пользователя	|
| email      	| string 	|     Электронная почта пользователя    	|
| role       	| string 	|     Роль пользователя      	|
| password      	| string 	|     Пароль пользователя     	|


**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
* Код ответа: 422
  ```json
    {
         "detail": [
            {
             "loc": [
                "string",
                 0
             ],
            "msg": "string",
            "type": "string"
            }
       ]
    }
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|  Пользователь успешно создан       	|   	|
| 422        	|  Есть логическая ошибка        	|   	|

**Пример запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___
## POST /v1/users/{username}/delete

**Описание:**  удаление пользователя. 

**Метод:**  POST

**URL:**  /api/v1/users/delete

**Параметры запроса:** 
| Параметр      	| Тип    	| Описание 	|
|---------------	|--------	|----------	|
| username    	| string 	|    	Имя удаляемого пользователя	|

**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
* Код ответа: 422
  ```json
    {
         "detail": [
            {
             "loc": [
                "string",
                 0
             ],
            "msg": "string",
            "type": "string"
            }
       ]
    }
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|  Успешное удаление  пользователя   	|   	|
| 422        	|  Есть логическая ошибка        	|   	|

**Пример запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___
## POST /v1/secrets/create
**Описание:**  запрос на  создание нового секрета в системе.

**Метод:**  POST

**URL:**  /api/v1/secrets/create

**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
* Код ответа: 422
  ```json
    {
         "detail": [
            {
             "loc": [
                "string",
                 0
             ],
            "msg": "string",
            "type": "string"
            }
       ]
    }
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|  Успешное создание секрета    	|   	|
| 422        	|  Есть логическая ошибка        	|   	|
**Привер запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___

## GET /v1/secrets/{secret_id}

**Описание:**  получение информации о конкретном секрете. 

**Метод:**  GET

**URL:**  /api/v1/secrets

**Параметры запроса:** 
| Параметр      	| Тип    	| Описание 	|
|---------------	|--------	|----------	|
| secret_id    	| string 	|    Идентификатор секрета     	|

**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
* Код ответа: 422
  ```json
    {
         "detail": [
            {
             "loc": [
                "string",
                 0
             ],
            "msg": "string",
            "type": "string"
            }
       ]
    }
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|  Успешное получение информации о секрете  	|   	|
| 422        	|  Есть логическая ошибка        	|   	|

**Пример запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___
## GET /v1/secrets
**Описание:**  получение списка секретов.

**Метод:**  GET

**URL:**  /api/v1/secrets

**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|   Успешное  получение писка секретов|   	|

**Привер запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___
## GET /v1/sys/settings

**Описание:**  получает список всех системных настроек

**Метод:**  GET

**URL:**  /api/v1/settings


**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```

**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|  Successful Retrieval of System Settings List	|   	|


**Пример запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___
## POST /v1/sys/security
**Описание:**  запрос на настройки или обновление конфигурации безопасности в системе.

**Метод:**  POST

**URL:**  /api/v1/sys/security

**Параметры запроса:** 

**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|   Успешная настройка или обновление 

**Привер запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___

## POST /v1/sys/setting
**Описание:**  запрос на создание или обновление конкретной системной настройки

**Метод:**  POST

**URL:**  api/v1/sys/setting
**Параметры запроса:** 

**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|   Успешное или обновление 

**Привер запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___
## GET /v1/sys/setting/{setting_key}
**Описание:**  запрос на получение значения конкретной системной настройки, идентифицируемой предоставленным setting_key

**Метод:**  GET

**URL:**  /api/v1/sys/setting/{setting_key}


**Ответ:**
* Код ответа: 200
  ```json
  "string"
  ```
* Код ответа: 422
  ```json
    {
         "detail": [
            {
             "loc": [
                "string",
                 0
             ],
            "msg": "string",
            "type": "string"
            }
       ]
    }
**Ответы сервера:**
| Код ответа 	| Описание 	|   	|
|------------	|----------	|---	|
| 200        	|  Успешное получение конкретной системной настройки	|   	|
| 422        	|  Есть логическая ошибка        	|   	|

**Пример запроса:**

Запрос:

```shell

```
Ответ:
```json

```
___